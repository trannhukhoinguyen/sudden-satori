---
import LogoYoutube from "./LogoYoutube.astro";

// Get the frontmatter data
const { frontmatter } = Astro.props;
---

<div class="mb-8 space-y-6">
    {
        // Single video
        frontmatter?.videoId && (
          <div class="video-container">
              <iframe
                src={`https://www.youtube.com/embed/${frontmatter.videoId}?start=${frontmatter.videoStart ? frontmatter.videoStart : 0}`}
                title={frontmatter.title}
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen
                width="100%"
                style="min-height: 500px"
              ></iframe>
          </div>
    )
    }

    {
        // Multiple videos
        frontmatter?.videoIds?.length &&
          frontmatter?.videoIds?.map((id: any, index: number) => (
            <div class="video-container">
                <iframe
                  src={`https://www.youtube.com/embed/${id}?start=${frontmatter.videoStarts?.length ? frontmatter.videoStarts[index] : 0}`}
                  title={`${frontmatter.title} - ${index + 1}`}
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                  allowfullscreen
                  width="100%"
                  style="min-height: 500px"
                ></iframe>
            </div>
          ))
    }

    {
        // YouTube playlist
        frontmatter?.videoPlaylist && (
          <div class="video-container playlist">
              <iframe
                src={`https://www.youtube.com/embed/videoseries?list=${frontmatter.videoPlaylist}`}
                title={frontmatter.title + " playlist"}
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen
                width="100%"
                style="min-height: 500px"
              ></iframe>
              <a
                href={`https://www.youtube.com/playlist?list=${frontmatter.videoPlaylist}`}
                target="_blank"
                rel="noopener"
                class="playlist-link"
              >
                  Xem to√†n b·ªô playlist tr√™n YouTube
              </a>
          </div>
    )
    }

    {
        // Single audio
        frontmatter?.audioUrl && (
          <div>
              <h3 class="text-xl font-bold mb-4" title="Listen">üéß</h3>
              <video width="640" height="360" controls poster="/cover.jpg">
                  <source src={frontmatter.audioUrl} type="audio/mpeg" />
                  <track src={frontmatter.vtt} kind="subtitles" srclang="en" label="Lyrics" default />
              </video>
          </div>
    )
    }

    {
        // Multiple audios
        frontmatter?.audioUrls?.length &&
          frontmatter?.audioUrls?.map((url: any, index: number) => (
            <div class="audio-block">
                {index === 0 ? <h3 class="audio-heading" title="Listen">üéß</h3> : ''}
                <h4 class="audio-subheading" title={url}>{index + 1}</h4>
                <audio controls class="audio-player">
                    <source src={url} type="audio/mpeg" />
                    Your browser does not support the audio element.
                </audio>
            </div>
          ))
    }
</div>

<style>
    /* Playlist container */
    .video-container {
        position: relative;
        width: 100%;
        height: 500px; /* fix chi·ªÅu cao */
        border-radius: 8px;
        overflow: hidden;
    }

    .video-container iframe {
        width: 100%;
        height: 100%;
        border: 0;
    }

    /* Link xem playlist */
    .playlist-link {
        display: none;         /* ·∫©n m·∫∑c ƒë·ªãnh */
        margin-top: 0.5rem;
        color: #facc15;        /* v√†ng chanh ki·ªÉu Tailwind yellow-400 */
        text-decoration: underline;
        font-weight: bold;
    }

    /* Khi d∆∞·ªõi 768px (mobile) th√¨ hi·ªán link */
    @media (max-width: 768px) {
        .playlist-link {
            display: block;
        }
    }


    .video-container {
        position: relative;
        width: 100%;
        height: 500px; /* default desktop */
        border-radius: 8px;
        overflow: hidden;
    }

    .video-container iframe {
        width: 100%;
        height: 100%;
        border: 0;
    }

    /* Mobile breakpoint */
    @media (max-width: 768px) {
        .video-container {
            height: auto;
            aspect-ratio: 16 / 9;
        }
    }
</style>
