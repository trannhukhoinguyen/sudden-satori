<script>
  declare global {
    interface Window {
      scrollVelocity: number;
      scrollDirection: number;
      scrollCurrent: number;
      scrollStickyOffsets: [number, number, number][];
    }
  }

  import Lenis from "lenis";
  import ScrollTrigger from "gsap/ScrollTrigger";
  import { addGlobalTicker } from "../utils/globalTicker";

  window.scrollStickyOffsets = window.scrollStickyOffsets || [];
  window.scrollVelocity = 0;
  window.scrollDirection = 1;

  const lenis = new Lenis({
    syncTouch: true,
    lerp: 0.125,
  });
  lenis.on("scroll", ScrollTrigger.update);

  lenis.direction = 1;

  addGlobalTicker((t: number) => {
    lenis.raf(t * 1000);
    window.scrollVelocity = lenis.velocity;
    window.scrollDirection = lenis.direction;
    window.scrollCurrent = lenis.animatedScroll;
  });
</script>

<style>
  html.lenis,
  html.lenis body {
    height: auto;
  }

  .lenis:not(.lenis-autoToggle).lenis-stopped {
    overflow: clip;
  }

  .lenis.lenis-smooth [data-lenis-prevent] {
    overscroll-behavior: contain;
  }

  .lenis.lenis-smooth iframe {
    pointer-events: none;
  }

  .lenis.lenis-autoToggle {
    transition-property: overflow;
    transition-duration: 1ms;
    transition-behavior: allow-discrete;
  }
</style>
