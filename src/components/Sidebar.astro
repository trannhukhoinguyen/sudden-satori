---
import { CATEGORY_MAP, TAG_MAP, getRecentPosts } from "../utils/getMarkdownContent";
import { configNew as config } from "../config";

const base = import.meta.env.BASE_URL;

// ðŸ‘‰ Láº¥y táº¥t cáº£ categories vÃ  tags (toÃ n site)
const categories = Object.keys(CATEGORY_MAP).sort();
const tags = Object.keys(TAG_MAP).sort();

// ðŸ‘‰ Recent posts toÃ n site
const recentPosts = getRecentPosts();
---

<div class="sidebar-content">
  <!-- Recent Posts -->
  {recentPosts.length > 0 && (
      <section class="recent-posts">
        <h3 class="section-title">BÃ i viáº¿t gáº§n Ä‘Ã¢y</h3>
        <ul class="post-list">
          {recentPosts.map(post => (
              <li class="post-item">
                <a
                    href={`${base}${post.frontmatter.type}/${post.file.split('/').pop()?.replace(/\.(md|mdx)$/, '')}`}
                    class="post-link"
                >
                  {post.frontmatter.title}
                </a>
                <time class="post-date" datetime={post.frontmatter.date}>
                  {new Date(post.frontmatter.date).toLocaleDateString("vi-VN", {
                    year: "numeric",
                    month: "long",
                    day: "numeric",
                  })}
                </time>
              </li>
          ))}
        </ul>
      </section>
  )}

  <!-- Categories -->
  {categories.length > 0 && (
      <section class="categories">
        <h3 class="section-title">ChuyÃªn má»¥c</h3>
        <ul class="category-list">
          {categories.map(category => (
              <li class="category-item">
                <a
                    href={`${base}categories/${category.toLowerCase().replace(/\s+/g, "-")}`}
                    class="category-link"
                >
                  {category} ({CATEGORY_MAP[category].posts.length})
                </a>
              </li>
          ))}
        </ul>
      </section>
  )}

  <!-- Tags -->
  {tags.length > 0 && (
      <section class="tags">
        <h3 class="section-title">Tháº»</h3>
        <ul class="tag-list">
          {tags.map(tag => (
              <li class="tag-item">
                <a
                    href={`${base}tags/${tag.toLowerCase().replace(/\s+/g, "-")}`}
                    class="tag-link"
                >
                  {tag} ({TAG_MAP[tag].posts.length})
                </a>
              </li>
          ))}
        </ul>
      </section>
  )}
</div>
