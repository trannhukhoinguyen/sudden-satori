---
import { calculateReadingTime, extractTextFromMarkdown } from "../../utils/reading-time";
import PdfViewer from "../ui/PdfViewer.astro";
import SpeechViewer from "../ui/SpeechViewer.astro";


const { post } = Astro.props;

const rawContent = post.body || post.rawContent?.() || "";
const plainText = extractTextFromMarkdown(rawContent);
const readingTime = calculateReadingTime(plainText);
---

<span class="post-reading-time">
    ⌛️
    {readingTime}

    <!-- PDF Viewer -->
    {
        post.frontmatter.pdfUrl && <PdfViewer pdfUrl={post.frontmatter.pdfUrl} title={post.frontmatter.title} />
    }
    {
        post.frontmatter.pdfUrl2 && <PdfViewer pdfUrl={post.frontmatter.pdfUrl2} title={post.frontmatter.title} />
    }
    {
        post.frontmatter.pdfUrls
        && post.frontmatter.pdfUrls?.length
        && post.frontmatter.pdfUrls?.map((pdfUrl, index) => <PdfViewer pdfUrl={pdfUrl} title={post.frontmatter.title + ` ${index + 1}`} key={index} />)
    }
    {
        post.frontmatter.type === 'masters' && post.frontmatter.speechUrl && <SpeechViewer speechUrl={post.frontmatter.speechUrl} title={post.frontmatter.title} />
    }
</span>
